# setw is set-window-option
# set -g means global, set -ag means append to existing setting

# NOTICE: Tmux runs this shell as login shell. This has to be a full path.
# Seting this changes the $SHELL variable.
#set -g default-shell "zsh"

# To not run as login shell, specify this. Can by any command. 
# This doesn't change the $SHELL variable.
# If defined as `/usr/bin/command`, the command is run directly.
# Same for `/usr/bin/env command`, `env` runs first, then `command`.
# Useful if using something like homebrew.
# If defined as just `command`, the command is run withing $SHELL.
# Some config run it through exec, TODO figure out why.
set -g default-command "/usr/bin/env fish"

set -g default-terminal "tmux-256color"
#set -ag terminal-overrides ",xterm-*:Tc" # https://github.com/kovidgoyal/kitty/issues/312#issuecomment-363392320

# If you reattach to a tmux that was created with an older SWAYSOCK then you're not goind to be able to run
# swaymsg from the command line, for example theme() function won't work because it runs `swaymsg reload`
# https://wiki.archlinux.org/index.php/Sway#Sway_socket_not_detected
# https://github.com/swaywm/sway/issues/460
#set -g update-environment "SSH_AUTH_SOCK SSH_AGENT_PID SWAYSOCK"

# https://unix.stackexchange.com/questions/23138/esc-key-causes-a-small-delay-in-terminal-due-to-its-alt-behavior
set -s escape-time 1 # milliseconds; fixes Esc delay

set -s focus-events on # man entry unclear

set -sg repeat-time 600 # milliseconds; if key binding has -r option, it can be repeated withing 500 milliseconds by default
	
set -g base-index 1 # start windows numbering at 1
set -g pane-base-index 1 # start pane numbering at 1
set -g renumber-windows on # renumber windows when a window is closed

set -g automatic-rename on # rename window to reflect current program
set -g monitor-activity on # windows with activity are hightlighted in the status line
set -g visual-activity off # don't show message instead of sending a bell

# History scrollback lines
set -g history-limit 10000

# terminal window title
set -g set-titles on
set -g set-titles-string '#I:#W ###S #(whoami)@#H ' 

# see man tmux STYLES sections 
# bg is the background beyond text but fill is the background beyond the section
# Seems like it is better to set styles inside `format` rather than `style` because
# not everything worked for me using `style`, for example `noreverse` on `current`
# set -g status off # hidden by default, toggle with shortcut defined bellow
set -g status-interval 3 # seconds
# set -g status-position top
set -g status-left ' '
set -g status-right-length 100
# set -g status-justify centre # window tabs; `centre` for center
# base16fg-to-term: 04-colour20 05-colour07 06-colour21 
# base16bg-to-term: 00-colour0 01-colour18 02-colour19 03-colour8 07-colour15
#                           7 / 8
set -g status-style fg=colour7,bg=colour0
#set -g window-status-separator '  ' # default is one space
# set -g window-status-format '  #{?window_last_flag,#[bold],}#I #W '
# set -g window-status-current-format '#[reverse bold]  #I #W  '
set -g window-status-style fg=colour2
set -g window-status-last-style fg=colour6
set -g window-status-activity-style fg=colour3
set -g window-status-current-style fg=colour4
set -g status-right ' ###S #(whoami)@#H ' # ## is escaped #
# set -g status-right '#(~/dotfiles/tmux/status #{pane_current_path} ) ###S #(whoami)@#H' # ## is escaped #
set -g message-style default
set -g message-command-style default

# set -g pane-border-status bottom
# set -g pane-border-format ''

# no active border highlight
set -g pane-border-style fg=colour8
set -g pane-active-border-style fg=colour7

set -g clock-mode-style 24

# Make shift+arrows, ctrl+arrows etc work in Vim.
set -g xterm-keys on

# vi mode copy mode
set -gw mode-keys vi
# set -g status-keys vi

#set -g mouse-utf8 on
set -g mouse on

# yank to system clipboard instead of tmux buffer
#bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "wl-copy --trim-newline"
#bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "wl-copy --trim-newline"

# reload configuration
bind r source-file ~/.tmux.conf \; display '~/.tmux.conf sourced'

# sessions
set -g detach-on-destroy off # don't detach client on kill-ession
# set-hook -g client-attached 'run-shell "#{@resurrect-restore-script-path} quiet"'

# bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
# bind-key -T choice-mode-vi h send-keys -X tree-collapse
# bind-key -T choice-mode-vi l send-keys -X tree-expand
# bind-key -T choice-mode-vi H send-keys -X tree-collapse-all
# bind-key -T choice-mode-vi L send-keys -X tree-expand-all

